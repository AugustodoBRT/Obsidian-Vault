---
mes_relatorio: 2025-10
tipo: relatorio-mensal
resumo_lucro: 0
resumo_investido: 0
resumo_apostas: 0
resumo_acertos: 0
resumo_odd_soma: 0
---
### üí∞ Lucro/Perda no M√™s
> [!multi-column]
>
> > [!tip]+ Lucro/Perda no M√™s
> > ```dataviewjs
> > // --- 1. CONFIGURA√á√ÉO ---
> > const mesAlvoString = dv.current().mes_relatorio;
> > 
> > // --- CORRE√á√ÉO AQUI ---
> > // O script s√≥ roda se 'mes_relatorio' estiver definido
> > if (!mesAlvoString) { 
> >     dv.el("h2", "ERRO: Defina 'mes_relatorio: YYYY-MM' no frontmatter (no topo desta nota)."); 
> > } else {
> >     // --- O SCRIPT COME√áA AQUI ---
> >     const mesAlvo = dv.date(mesAlvoString);
> > 
> >     // --- 2. FUN√á√ÉO HELPER DE C√ÅLCULO ---
> >     function calcularLucro(p) {
> >         const valor = Number((p.valor_apostado || '0').toString().replace(",", ".")) || 0;
> >         const odd = Number((p.odd || '0').toString().replace(",", ".")) || 0;
> >         const resultado = (p.resultado || "").toLowerCase();
> >         if (resultado == 'green') return (valor * odd) - valor;
> >         if (resultado == 'red') return -valor;
> >         return 0;
> >     }
> > 
> >     // --- 3. FILTRO ---
> >     const pages = dv.pages('#aposta')
> >         .where(p => {
> >             const dataValida = dv.date(p.data);
> >             const resultado = (p.resultado || "").toLowerCase();
> >             const eResolvida = (resultado === 'green' || resultado === 'red');
> >             return dataValida && eResolvida &&
> >                    dataValida.year === mesAlvo.year && 
> >                    dataValida.month === mesAlvo.month;
> >         });
> > 
> >     // --- 4. C√ÅLCULO ---
> >     const lucroTotal = pages.map(calcularLucro).array().reduce((a, b) => a + b, 0);
> >     const cor = lucroTotal > 0 ? '#43cc56' : (lucroTotal < 0 ? '#f04134' : '#a0a0a0');
> > 
> >     // --- 5. DISPLAY (Card) ---
> >     // Card com 'height: 100%' para alinhar com a coluna ao lado
> >     const card = dv.el('div', '', {
> >         attr: { style: 'padding: 20px; background-color: #1e1e1e; border-radius: 8px; text-align: center; border: 1px solid #333; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;' }
> >     });
> >     
> >     // T√≠tulo foi removido (como voc√™ pediu)
> > 
> >     dv.el('div', `R$ ${lucroTotal.toFixed(2)}`, {
> >         parent: card,
> >         attr: { style: `font-size: 3.5em; font-weight: 700; color: ${cor};` }
> >     });
> > }
> > ```
>
> > [!example]+ Banca Utilizada
> > ```dataviewjs
> > // --- 1. CONFIGURE AQUI O VALOR DA BANCA ---
> > const bancaUtilizada = 1000; // Voc√™ pode mudar este valor
> > // --- FIM DA CONFIGURA√á√ÉO ---
> > 
> > 
> > // --- 2. DISPLAY (Card) ---
> > // Card com 'height: 100%' para alinhar com a coluna ao lado
> > const card = dv.el('div', '', {
> >     attr: { style: 'padding: 20px; background-color: #1e1e1e; border-radius: 8px; text-align: center; border: 1px solid #333; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;' }
> > });
> > 
> > 
> >
> > dv.el('div', `R$ ${bancaUtilizada.toFixed(2)}`, {
> >     parent: card,
> >     attr: { style: 'font-size: 3.5em; font-weight: 700; color: #ffffff;' }
> > });
> > ```

> [!multi-column]
>
> > [!info]+ Desempenho Di√°rio
> > ```dataviewjs
> > // --- 1. CONFIGURA√á√ÉO ---
> > const mesAlvoString = dv.current().mes_relatorio;
> >
> > // --- CORRE√á√ÉO AQUI ---
> > if (!mesAlvoString) { 
> >     dv.el("b", "ERRO: Defina 'mes_relatorio'");
> > } else {
> >     // --- O SCRIPT COME√áA AQUI ---
> >     const mesAlvo = dv.date(mesAlvoString);
> >     
> >     // --- 2. FUN√á√ÉO HELPER DE C√ÅLCULO ---
> >     function cL(p) {
> >         const valor = Number((p.valor_apostado || '0').toString().replace(",", ".")) || 0;
> >         const odd = Number((p.odd || '0').toString().replace(",", ".")) || 0;
> >         const resultado = (p.resultado || "").toLowerCase();
> >         if (resultado == 'green') return (valor * odd) - valor;
> >         if (resultado == 'red') return -valor;
> >         return 0;
> >     }
> > 
> >     // --- 3. FILTRO ---
> >     const pages = dv.pages('#aposta')
> >        .where(p => {
> >            const dataValida = dv.date(p.data);
> >            const resultado = (p.resultado || "").toLowerCase();
> >            const eResolvida = (resultado === 'green' || resultado === 'red');
> >            return dataValida && eResolvida &&
> >                   dataValida.year === mesAlvo.year && 
> >                   dataValida.month === mesAlvo.month;
> >        });
> >
> >     // --- 4. C√ÅLCULO (Agrupamento por dia) ---
> >     const lucrosPorDia = pages
> >         .groupBy(p => dv.date(p.data))
> >         .map(g => ({
> >             data: g.key,
> >             lucro: g.rows.map(cL).array().reduce((a, b) => a + b, 0)
> >         }))
> >         .sort(g => g.data, 'asc');
> >
> >     // --- 5. DISPLAY (Tabela Di√°ria) ---
> >     function createRow(dia) {
> >         const cor = dia.lucro > 0 ? '#43cc56' : (dia.lucro < 0 ? '#f04134' : '#a0a0a0');
> >         const dataFmt = dia.data.toFormat("dd-MMM");
> >         const lucroFmt = `R$ ${dia.lucro.toFixed(2)}`;
> >         
> >         return [
> >             `<span style="font-weight: 600;">${dataFmt}</span>`,
> >             `<span style="font-weight: 600; color: ${cor};">${lucroFmt}</span>`
> >         ];
> >     }
> >
> >     const tabela = lucrosPorDia.map(createRow);
> >     dv.table(["Data", "Lucro/Perda"], tabela);
> > }
> > ```
>
> > [!info]+ Resumo do M√™s
> > ### Por Esporte
> > ```dataviewjs
> > // --- 1. CONFIGURA√á√ÉO ---
> > const mesAlvoString = dv.current().mes_relatorio;
> >
> > // --- CORRE√á√ÉO AQUI ---
> > if (!mesAlvoString) { 
> >     dv.el("b", "ERRO: Defina 'mes_relatorio'");
> > } else {
> >     // --- O SCRIPT COME√áA AQUI ---
> >     const mesAlvo = dv.date(mesAlvoString);
> >
> >     // --- 2. FUN√á√ÉO HELPER DE C√ÅLCULO ---
> >     function cL(p) {
> >         const valor = Number((p.valor_apostado || '0').toString().replace(",", ".")) || 0;
> >         const odd = Number((p.odd || '0').toString().replace(",", ".")) || 0;
> >         const resultado = (p.resultado || "").toLowerCase();
> >         if (resultado == 'green') return (valor * odd) - valor;
> >         if (resultado == 'red') return -valor;
> >         return 0;
> >     }
> > 
> >     // --- 3. FILTRO ---
> >     const pages = dv.pages('#aposta')
> >        .where(p => {
> >            const dataValida = dv.date(p.data);
> >            const resultado = (p.resultado || "").toLowerCase();
> >            const eResolvida = (resultado === 'green' || resultado === 'red');
> >            return dataValida && eResolvida &&
> >                   dataValida.year === mesAlvo.year && 
> >                   dataValida.month === mesAlvo.month;
> >        });
> >
> >     // --- 4. C√ÅLCULO (Agrupamento por Esporte) ---
> >     const porEsporte = pages
> >         .groupBy(p => p.esporte || "N/A")
> >         .map(g => {
> >             const investido = g.rows.map(p => Number(p.valor_apostado) || 0).array().reduce((a, b) => a + b, 0);
> >             const lucro = g.rows.map(cL).array().reduce((a, b) => a + b, 0);
> >             const roi = (investido === 0) ? 0 : (lucro / investido) * 100;
> >             return {
> >                 esporte: g.key,
> >                 apostas: g.rows.length,
> >                 investido: `R$ ${investido.toFixed(2)}`,
> >                 lucro: lucro,
> >                 roi: roi
> >             };
> >         });
> >
> >     // --- 5. DISPLAY (Tabela Esporte) ---
> >     const tabela = porEsporte.map(e => {
> >         const corLucro = e.lucro > 0 ? '#43cc56' : (e.lucro < 0 ? '#f04134' : '#a0a0a0');
> >         const corROI = e.roi > 0 ? '#43cc56' : (e.roi < 0 ? '#f04134' : '#a0a0a0');
> >         return [
> >             `<span style="font-weight: 600;">${e.esporte}</span>`,
> >             e.apostas,
> >             e.investido,
> >             `<span style="font-weight: 600; color: ${corLucro};">R$ ${e.lucro.toFixed(2)}</span>`,
> >             `<span style="font-weight: 600; color: ${corROI};">${e.roi.toFixed(2)}%</span>`
> >         ];
> >     });
> >     dv.table(["Esporte", "Apostas", "Investido", "Lucro/Perda", "ROI"], tabela);
> > }
> > ```
> > ### Por Tipster
> > ```dataviewjs
> > // --- 1. CONFIGURA√á√ÉO ---
> > const mesAlvoString = dv.current().mes_relatorio;
> >
> > // --- CORRE√á√ÉO AQUI ---
> > if (!mesAlvoString) { 
> >     dv.el("b", "ERRO: Defina 'mes_relatorio'");
> > } else {
> >     // --- O SCRIPT COME√áA AQUI ---
> >     const mesAlvo = dv.date(mesAlvoString);
> >     
> >     // --- 2. FUN√á√ÉO HELPER DE C√ÅLCULO ---
> >     function cL(p) {
> >         const valor = Number((p.valor_apostado || '0').toString().replace(",", ".")) || 0;
> >         const odd = Number((p.odd || '0').toString().replace(",", ".")) || 0;
> >         const resultado = (p.resultado || "").toLowerCase();
> >         if (resultado == 'green') return (valor * odd) - valor;
> >         if (resultado == 'red') return -valor;
> >         return 0;
> >     }
> > 
> >     // --- 3. FILTRO ---
> >     const pages = dv.pages('#aposta')
> >        .where(p => {
> >            const dataValida = dv.date(p.data);
> >            const resultado = (p.resultado || "").toLowerCase();
> >            const eResolvida = (resultado === 'green' || resultado === 'red');
> >            return dataValida && eResolvida &&
> >                   dataValida.year === mesAlvo.year && 
> >                   dataValida.month === mesAlvo.month;
> >        });
> >
> >     // --- 4. C√ÅLCULO (Agrupamento por Tipster) ---
> >     const porTipster = pages
> >         .groupBy(p => p.tipster || "Eu")
> >         .map(g => {
> >             const investido = g.rows.map(p => Number(p.valor_apostado) || 0).array().reduce((a, b) => a + b, 0);
> >             const lucro = g.rows.map(cL).array().reduce((a, b) => a + b, 0);
> >             const roi = (investido === 0) ? 0 : (lucro / investido) * 100;
> >             return {
> >                 tipster: g.key,
> >                 apostas: g.rows.length,
> >                 investido: `R$ ${investido.toFixed(2)}`,
> >                 lucro: lucro,
> >                 roi: roi
> >             };
> >         });
> >
> >     // --- 5. DISPLAY (Tabela Tipster) ---
> >     const tabela = porTipster.map(t => {
> >         const corLucro = t.lucro > 0 ? '#43cc56' : (t.lucro < 0 ? '#f04134' : '#a0a0a0');
> >         const corROI = t.roi > 0 ? '#43cc56' : (t.roi < 0 ? '#f04134' : '#a0a0a0');
> >         return [
> >             `<span style="font-weight: 600;">${t.tipster}</span>`,
> >             t.apostas,
> >             t.investido,
> >             `<span style="font-weight: 600; color: ${corLucro};">R$ ${t.lucro.toFixed(2)}</span>`,
> >             `<span style="font-weight: 600; color: ${corROI};">${t.roi.toFixed(2)}%</span>`
> >         ];
> >     });
> >     dv.table(["Tipster", "Apostas", "Investido", "Lucro/Perda", "ROI"], tabela);
> > }
> > ```

---

```dataviewjs
function createStat(label, value, color = "#ffffff") {
    // ... (fun√ß√£o igual) ...
    return dv.el('div', [
        dv.el('span', `${label}: `, { 
            attr: { style: 'font-size: 12px; color: #a0a0a0; text-transform: uppercase; margin: 0; padding: 0; font-weight: 600;' }
        }),
        dv.el('span', value, { 
            attr: { style: `font-size: 14px; font-weight: 600; color: ${color}; margin: 0; padding: 0;` }
        })
    ], { 
        attr: { style: 'text-align: left; margin: 0 0 0 16px; padding: 0; white-space: nowrap; flex-shrink: 0' }
    });
}
function createBadge(text, bgColor = "#333", textColor = "#fff") {
    // ... (fun√ß√£o igual) ...
    if (!text) return dv.el('span', '');
    return dv.el('span', text, {
        attr: { style: `font-size: 12px; font-weight: 600; padding: 2px 6px; border-radius: 4px; background-color: ${bgColor}; color: ${textColor}; white-space: nowrap; flex-shrink: 0;` }
    });
}

// --- MUDAN√áA AQUI: Prepara√ß√£o para cores din√¢micas ---
const assignedCasaColors = {}; // Guarda as cores j√° atribu√≠das (ex: { "bet365": { bg: "#ff0000", text: "#fff" } })
let nextHue = Math.floor(Math.random() * 360); // Come√ßa com uma matiz HSL aleat√≥ria
const colorSaturation = 75; // Satura√ß√£o fixa (cores vivas)
const colorLightness = 45; // Luminosidade fixa (cores n√£o muito claras nem escuras)
// --- FIM DA MUDAN√áA ---

// Pega o m√™s do frontmatter da nota atual
const mesAlvoString = dv.current().mes_relatorio;

if (!mesAlvoString) { 
    dv.el("h2", "ERRO: Defina 'mes_relatorio: YYYY-MM' no frontmatter."); 
} else {
    const mesAlvo = dv.date(mesAlvoString);

    // Coleta e filtra as notas do M√äS ALVO
    const pages = dv.pages('#aposta')
        .where(p => {
            const dataValida = dv.date(p.data);
            if (!dataValida) return false;
            return dataValida.year === mesAlvo.year && 
                   dataValida.month === mesAlvo.month;
        })
        .sort(p => p.file.ctime, 'desc'); 

    for (let page of pages) {
        const odd_num = Number((page.odd || '0').toString().replace(",", ".")) || 0;
        const valor = Number((page.valor_apostado || '0').toString().replace(",", ".")) || 0;
        
        const resultado = (page.resultado || 'pendente').toLowerCase().trim();
        let lucro = 0;
        if (resultado == 'green') {
            lucro = (valor * odd_num) - valor;
        } else if (resultado == 'red') {
            lucro = -valor;
        }

        const casa = (typeof page.casa === "string" ? page.casa.trim() : "N/A");
        const esporte = (typeof page.esporte === "string" ? page.esporte.trim() : "Aposta");
        const ganho = valor + lucro;

        // Cores
        const corGreen = "#43cc56";
        const corRed = "#f04134";
        const corGrey = "#a0a0a0";
        const corOdd = "#e6c07b"; 
        const corValor = "#61afef"; 

        let corLucro = corGrey, corGanho = corGrey;
        if (resultado == 'green') corLucro = corGanho = corGreen;
        if (resultado == 'red') {
            corLucro = corRed;
            corGanho = (ganho > 0) ? corGreen : corRed;
        }
        if (lucro == 0) corLucro = corGrey;

        // --- MUDAN√áA AQUI: L√≥gica de atribui√ß√£o autom√°tica de cor para CASAS ---
        let corCasaObj;
        const casaLower = casa.toLowerCase();

        if (assignedCasaColors[casaLower]) {
            // Se a casa j√° tem cor, usa ela
            corCasaObj = assignedCasaColors[casaLower];
        } else {
            // Se √© uma casa nova, gera uma cor HSL
            const bgColor = `hsl(${nextHue}, ${colorSaturation}%, ${colorLightness}%)`;
            // Para simplificar, vamos usar texto branco. 
            // Uma l√≥gica mais complexa poderia calcular a luminosidade do bg.
            const textColor = '#ffffff'; 
            
            corCasaObj = { bg: bgColor, text: textColor };
            
            // Guarda a cor para futuras ocorr√™ncias desta casa NESTA EXECU√á√ÉO
            assignedCasaColors[casaLower] = corCasaObj;
            
            // Prepara a pr√≥xima matiz (Hue) - pulando um valor para tentar cores diferentes
            nextHue = (nextHue + 37) % 360; // Pula 37 graus no c√≠rculo crom√°tico
        }
        // --- FIM DA MUDAN√áA ---

        // Cores para Esportes (mantive manual, mas poderia ser autom√°tico tamb√©m)
        const coresEsportes = {
            "futebol":   { bg: "#1f78b4", text: "#ffffff" },
            "basquete":  { bg: "#401c00", text: "#ffffff" },
            "tenis":     { bg: "#6a3d9a", text: "#ffffff" },
            "esports":   { bg: "#e31a1c", text: "#ffffff" }
        };
        const corEsportePadrao = { bg: "#444", text: "#fff" };
        const corEsporteObj = coresEsportes[esporte.toLowerCase()] || corEsportePadrao;

        // Card (c√≥digo igual)
        const card = dv.el('div', '', {
            attr: { style: 'display: flex; flex-direction: row; align-items: center; padding: 14px 16px; background-color: #1e1e1e; border-radius: 8px; margin-bottom: 8px; border: 1px solid #333; list-style: none; overflow-x: auto; white-space: nowrap;' }
        });
        // Badges (agora usa corCasaObj din√¢mico)
        const badges = dv.el('div', [
            createBadge(casa, corCasaObj.bg, corCasaObj.text), // <-- USA A COR DIN√ÇMICA
            createBadge(esporte, corEsporteObj.bg, corEsporteObj.text)
        ], { attr: { style: 'display: flex; flex-direction: row; margin: 0; padding: 0; gap: 6px; flex-shrink: 0;' } });
        card.appendChild(badges);
        // T√≠tulo (igual)
        const title = dv.el('div', dv.fileLink(page.file.path, false, page.file.name), {
            attr: { style: 'font-size: 16px; font-weight: 600; color: #fff; margin: 0 0 0 14px; padding: 0; line-height: 1.3; flex-shrink: 0;' } 
        });
        card.appendChild(title);
        
        // Stats (igual)
        card.appendChild(createStat("Cota√ß√£o", odd_num.toFixed(3), corOdd));
        card.appendChild(createStat("Valor", `${valor.toFixed(2)} R$`, corValor));
        card.appendChild(createStat("Lucro", `${lucro.toFixed(2)} R$`, corLucro));
        card.appendChild(createStat("Total", `${ganho.toFixed(2)} R$`, corGanho));
    }
}
```
